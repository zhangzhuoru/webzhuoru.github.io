"use strict";(self["webpackChunkpacket"]=self["webpackChunkpacket"]||[]).push([[312],{312:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"import-page"},[t("file-importer",{ref:"importer",attrs:{loading:e.loading},on:{"file-selected":e.handleFileImport,"import-error":e.handleImportError}}),t("van-button",{staticClass:"mt-12",attrs:{type:"primary",plain:"",block:"",loading:e.sampleLoading},on:{click:e.loadSampleBank}},[e._v(" 一键加载示例题库 ")]),e.questionBank?t("section",{staticClass:"card mt-16"},[t("h3",{staticClass:"section-title"},[e._v("题库概览")]),t("div",{staticClass:"info-grid"},[t("div",[t("p",{staticClass:"info-value"},[e._v(e._s(e.questionBank.total))]),t("p",{staticClass:"info-label"},[e._v("题目总数")])]),t("div",[t("p",{staticClass:"info-value"},[e._v(e._s(e.questionBank.levels.length))]),t("p",{staticClass:"info-label"},[e._v("关卡数量")])]),t("div",[t("p",{staticClass:"info-value"},[e._v(e._s(e.currentLevelTitle))]),t("p",{staticClass:"info-label"},[e._v("当前关卡")])])]),e.questionBank.description?t("p",{staticClass:"bank-desc"},[e._v(" "+e._s(e.questionBank.description)+" ")]):e._e()]):t("section",{staticClass:"card mt-16"},[t("van-empty",{attrs:{image:"search",description:"尚未导入题库"}},[t("van-button",{attrs:{size:"small",type:"primary"},on:{click:e.openPicker}},[e._v(" 立即导入 ")])],1)],1),e.questionBank?t("level-navigator",{staticClass:"mt-16",attrs:{levels:e.levels,"current-level-id":e.currentLevelId,"unlocked-levels":e.unlockedLevels},on:{select:e.handlePreviewLevel}}):e._e()],1)},i=[],a=s(353),n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-importer card"},[t("h3",{staticClass:"section-title"},[e._v("导入题库 JSON")]),t("p",{staticClass:"description"},[e._v(" 支持 PRD 中示例格式。系统会自动校验题库结构并生成关卡。 ")]),t("van-uploader",{attrs:{accept:e.accept,"after-read":e.handleAfterRead,disabled:e.loading,"max-size":e.maxSize},on:{oversize:e.handleOversize}}),t("van-button",{staticClass:"mt-12",attrs:{type:"primary",block:"",loading:e.loading},on:{click:e.triggerPicker}},[e._v(" "+e._s(e.loading?"正在导入...":"选择 JSON 文件")+" ")]),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".json,application/json"},on:{change:e.handleManualSelect}})],1)},r=[],o={name:"FileImporter",props:{loading:{type:Boolean,default:!1},accept:{type:String,default:".json,application/json"},maxSize:{type:Number,default:2097152}},methods:{handleAfterRead(e){this.$emit("file-selected",e.file||e)},handleManualSelect(e){const[t]=e.target.files||[];t&&this.$emit("file-selected",t),e.target.value=""},handleOversize(){this.$emit("import-error","文件超过 2MB，请压缩后再试")},triggerPicker(){this.$refs.fileInput?.click()}}},c=o,d=s(656),v=(0,d.A)(c,n,r,!1,null,"3fd93caf",null),p=v.exports,u=s(321),h={name:"ImportPage",components:{FileImporter:p,LevelNavigator:u.A},data(){return{loading:!1,sampleLoading:!1}},computed:{...(0,a.aH)("questions",["questionBank","levels","currentLevelId"]),...(0,a.L8)("progress",["unlockedLevels"]),currentLevelTitle(){const e=this.levels.find(e=>e.id===this.currentLevelId)||this.levels[0];return e?e.title:"-"}},methods:{...(0,a.i0)("questions",["importQuestionBank","importQuestionContent","loadLevelQuestions"]),async handleFileImport(e){this.loading=!0;try{await this.importQuestionBank(e),this.$toast.success("题库导入成功")}catch(t){this.$toast.fail(t.message||"导入失败")}finally{this.loading=!1}},handleImportError(e){this.$toast(e)},openPicker(){this.$refs.importer&&this.$refs.importer.triggerPicker&&this.$refs.importer.triggerPicker()},async loadSampleBank(){this.sampleLoading=!0;try{const e=await s.e(566).then(s.t.bind(s,566,19)),t=JSON.stringify(e.default||e);await this.importQuestionContent({content:t,fileName:"示例题库.json"}),this.$toast.success("示例题库已准备就绪")}catch(e){this.$toast.fail("加载示例题库失败")}finally{this.sampleLoading=!1}},handlePreviewLevel(e){this.loadLevelQuestions(e.id),this.$router.push({name:"Quiz"})}}},f=h,m=(0,d.A)(f,l,i,!1,null,"9f1e47b0",null),_=m.exports},321:function(e,t,s){s.d(t,{A:function(){return c}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"level-nav card"},[t("div",{staticClass:"level-nav__header"},[t("h3",{staticClass:"section-title"},[e._v("关卡选择")]),e.levels.length?t("p",{staticClass:"level-nav__meta"},[e._v(" 已解锁 "+e._s(e.unlockedLevels.length)+"/"+e._s(e.levels.length)+" ")]):e._e()]),e.levels.length?t("div",{staticClass:"level-grid"},e._l(e.levels,function(s){return t("button",{key:s.id,staticClass:"level-cell",class:{active:s.id===e.currentLevelId,locked:!e.isUnlocked(s.id)},attrs:{type:"button"},on:{click:function(t){return e.handleSelect(s)}}},[t("div",{staticClass:"level-cell__head"},[t("span",{staticClass:"level-cell__title"},[e._v(e._s(s.title))]),t("van-icon",{attrs:{name:e.isUnlocked(s.id)?"success":"lock",color:e.isUnlocked(s.id)?"#10b981":"#f97316"}})],1),t("p",{staticClass:"level-cell__range"},[e._v(" 题目 "+e._s(s.start+1)+" - "+e._s(s.end)+" ")]),t("p",{staticClass:"level-cell__status"},[e._v(" "+e._s(e.isUnlocked(s.id)?"点击开始":"完成前一关解锁")+" ")])])}),0):t("van-empty",{attrs:{description:"请先导入题库"}})],1)},i=[],a={name:"LevelNavigator",props:{levels:{type:Array,default:()=>[]},currentLevelId:{type:String,default:""},unlockedLevels:{type:Array,default:()=>[]}},methods:{isUnlocked(e){return this.unlockedLevels.length?this.unlockedLevels.includes(e):e===this.levels[0]?.id},handleSelect(e){this.isUnlocked(e.id)?this.$emit("select",e):this.$toast("先完成前一关卡即可解锁")}}},n=a,r=s(656),o=(0,r.A)(n,l,i,!1,null,"4964e19e",null),c=o.exports}}]);
//# sourceMappingURL=312.3fc943f2.js.map